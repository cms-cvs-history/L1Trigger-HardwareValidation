#description
#-generate random digis (emul) 
#-introduce simple bias (data)
#-compare initial and modified digis
#-generate dqm sources

process testdummybiasde = {

    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    
    untracked PSet maxEvents = { untracked int32 input = 100 }
    
    path p = {
	l1dummy
	,l1bias 
	,l1compare
	,l1demon
    }
    
    source = EmptySource {}

    #generate dummy digis (e-digis)
    include "L1Trigger/HardwareValidation/data/L1DummyProducer.cfi"
    replace l1dummy.VerboseFlag = 0 

    #introduce bias (d-digis)
    include "L1Trigger/HardwareValidation/data/L1EmulBias.cfi"
    replace l1bias.VerboseFlag = 0 
    replace l1bias.ETPsource = l1dummy
    replace l1bias.HTPsource = l1dummy
    replace l1bias.RCTsource = l1dummy
    replace l1bias.GCTsource = l1dummy
    replace l1bias.DTPsource = l1dummy
    replace l1bias.DTFsource = l1dummy
    replace l1bias.CTPsource = l1dummy
    replace l1bias.CTFsource = l1dummy
    replace l1bias.CTTsource = l1dummy
    replace l1bias.RPCsource = l1dummy
    replace l1bias.LTCsource = l1dummy
    replace l1bias.GMTsource = l1dummy
    replace l1bias.GLTsource = l1dummy
    
    #d|e comparison
    include "L1Trigger/HardwareValidation/data/L1Comparator.cfi"
    replace l1compare.DumpMode = 1
    replace l1compare.VerboseFlag = 0
    replace l1compare.ETPsourceEmul = l1dummy
    replace l1compare.ETPsourceData = l1bias
    replace l1compare.HTPsourceEmul = l1dummy
    replace l1compare.HTPsourceData = l1bias
    replace l1compare.RCTsourceEmul = l1dummy
    replace l1compare.RCTsourceData = l1bias
    replace l1compare.GCTsourceEmul = l1dummy
    replace l1compare.GCTsourceData = l1bias
    replace l1compare.DTPsourceEmul = l1dummy
    replace l1compare.DTPsourceData = l1bias
    replace l1compare.DTFsourceEmul = l1dummy
    replace l1compare.DTFsourceData = l1bias
    replace l1compare.CTPsourceEmul = l1dummy
    replace l1compare.CTPsourceData = l1bias
    replace l1compare.CTFsourceEmul = l1dummy
    replace l1compare.CTFsourceData = l1bias
    replace l1compare.CTTsourceEmul = l1dummy
    replace l1compare.CTTsourceData = l1bias
    replace l1compare.RPCsourceEmul = l1dummy
    replace l1compare.RPCsourceData = l1bias
    replace l1compare.LTCsourceEmul = l1dummy
    replace l1compare.LTCsourceData = l1bias
    replace l1compare.GMTsourceEmul = l1dummy
    replace l1compare.GMTsourceData = l1bias
    replace l1compare.GLTsourceEmul = l1dummy
    replace l1compare.GLTsourceData = l1bias

    #select subsystems to be studied
    replace l1dummy.DO_SYSTEM       = { 1,1,1,1, 1,1,1,1,1, 0,1,0 }
    replace l1bias.DO_SYSTEM        = { 1,1,1,1, 1,1,1,1,1, 0,1,0 }
    replace l1compare.COMPARE_COLLS = { 1,1,1,1, 1,1,1,1,1, 0,1,0 }
    //sys list: ETP,HTP,RCT,GCT,  DTP,DTF,CTP,CTF,RPC,  LTC,GMU,GLT
    
    #produce histograms / dqm sources
    include "DQM/L1TMonitor/data/L1TDEMON.cfi"
    
    #random number services
    service =  RandomNumberGeneratorService {
	PSet moduleSeeds = {
	    untracked uint32 l1dummy = 1762349
	    untracked uint32 l1bias  = 7863453
	}
    }

    #dqm services
    //include "DQMServices/Core/data/DQM.cfg"
    service = DQMStore {}
    #service = DQM {
    #	untracked string collectorHost = "localhost"
    #	untracked int32  collectorPort = 9090
    #	untracked double publishFrequency = 5
    #	untracked bool   debug = false
    #}

    module outputEvents = PoolOutputModule {
    	untracked string fileName = "l1fakebias.root"
        untracked vstring outputCommands = {"keep *"}
    }
    #endpath outpath = { outputEvents }
    
}
